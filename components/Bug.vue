<template>
  <svg
    v-if="bug.orientation === 'top' && show"
    :width="bug.size * 38.7"
    :height="bug.size * 50"
    class="bug top"
    :class="additionalClasses"
    viewBox="0 0 387 500"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    :style="{
      color: bug.color.color,
      transform: `translate(${bug.translateX || 0},${bug.translateY || 0}) rotate(${
        bug.rotate || 0
      })`,
    }"
    @click="handleClick"
  >
    <path
      d="M385.604 285.242C385.604 362.563 364.074 416.108 329.341 450.324C294.605 484.543 246.596 499.5 193.5 499.5C140.409 499.5 92.3984 483.922 57.6607 449.389C22.9251 414.859 1.39575 361.312 1.39575 285.242C1.39575 215.589 31.1947 153.712 77.3312 114.584C87.756 108.522 96.918 101.853 105.707 95.2701C106.967 94.3266 108.219 93.385 109.465 92.4473C116.934 86.8303 124.217 81.3524 131.901 76.4284C149.811 64.9517 169.875 56.4999 199.323 56.4999C228.764 56.4999 246.241 64.9467 261.394 76.4062C266.948 80.6063 272.182 85.2054 277.589 89.9556C279.579 91.7036 281.592 93.472 283.653 95.2486C291.295 101.837 299.568 108.513 309.666 114.582C355.804 153.71 385.604 215.588 385.604 285.242Z"
      class="stroke"
      stroke="currentColor"
      :style="{ 'animation-duration': `${Math.random() * 10 + 2}s`, 'animation-name' : beacon ? 'periodicscale' : 'none' }"
    />
    <path
      d="M386.104 285.242C386.104 440.067 299.872 500 193.5 500C87.1276 500 0.895752 437.57 0.895752 285.242C0.895752 215.43 30.77 153.399 77.0416 114.174C118.698 89.9617 129.448 54.4999 193.5 54.4999C257.552 54.5 269.646 89.9617 309.958 114.174C356.23 153.399 386.104 215.43 386.104 285.242Z"
      fill="#000000"
    />
    <ellipse class="eye" cx="163.489" cy="86.5" rx="12.9896" ry="14.5" fill="white" />
    <ellipse class="eye" cx="223.51" cy="86.5" rx="12.9896" ry="14.5" fill="white" />
    <ellipse cx="166.625" cy="79" rx="3.58333" ry="4" fill="#000000" />
    <ellipse cx="220.375" cy="81" rx="3.58333" ry="4" fill="#000000" />
    <path
      d="M142.193 6.57353L141.054 8.21748L141.054 8.21749L142.193 6.57353ZM122.037 16.5735L120.061 16.8814L120.073 16.9575L120.09 17.0325L122.037 16.5735ZM135.923 26.5735L136.53 28.479L136.697 28.4257L136.853 28.3441L135.923 26.5735ZM138.53 10.7473C137.521 10.297 136.338 10.7495 135.888 11.7581C135.438 12.7667 135.89 13.9494 136.899 14.3998L138.53 10.7473ZM164.78 58.8082C163.791 51.4191 161.205 39.9637 157.554 29.431C155.727 24.1616 153.616 19.0706 151.276 14.8121C148.963 10.6008 146.316 6.99668 143.332 4.92957L141.054 8.21749C143.267 9.75039 145.55 12.6962 147.771 16.7381C149.965 20.7328 151.992 25.5979 153.775 30.7411C157.342 41.0334 159.863 52.228 160.815 59.3389L164.78 58.8082ZM143.332 4.92958C137.099 0.610866 130.79 -0.0618017 126.12 2.47832C121.414 5.03829 119.065 10.4877 120.061 16.8814L124.013 16.2657C123.218 11.1594 125.123 7.57433 128.032 5.99206C130.977 4.38994 135.641 4.46727 141.054 8.21748L143.332 4.92958ZM120.09 17.0325C121.274 22.0514 123.374 25.613 126.379 27.5637C129.433 29.5457 133.01 29.6018 136.53 28.479L135.315 24.6681C132.565 25.5453 130.318 25.3514 128.557 24.2084C126.747 23.034 125.04 20.5957 123.984 16.1146L120.09 17.0325ZM136.853 28.3441C145.66 23.7176 144.821 13.5565 138.53 10.7473L136.899 14.3998C139.565 15.5906 141.414 21.4295 134.992 24.803L136.853 28.3441Z"
      fill="black"
    />
    <path
      d="M244.562 6.57353L245.702 8.21748L245.702 8.21749L244.562 6.57353ZM264.719 16.5735L266.695 16.8814L266.683 16.9575L266.665 17.0325L264.719 16.5735ZM250.833 26.5735L250.225 28.479L250.058 28.4257L249.903 28.3441L250.833 26.5735ZM248.226 10.7473C249.235 10.297 250.417 10.7495 250.868 11.7581C251.318 12.7667 250.865 13.9494 249.857 14.3998L248.226 10.7473ZM221.976 58.8082C222.965 51.4191 225.55 39.9637 229.202 29.431C231.028 24.1616 233.14 19.0706 235.479 14.8121C237.793 10.6008 240.44 6.99668 243.423 4.92957L245.702 8.21749C243.489 9.75039 241.206 12.6962 238.985 16.7381C236.79 20.7328 234.764 25.5979 232.981 30.7411C229.413 41.0334 226.892 52.228 225.94 59.3389L221.976 58.8082ZM243.423 4.92958C249.657 0.610866 255.966 -0.0618017 260.635 2.47832C265.341 5.03829 267.691 10.4877 266.695 16.8814L262.743 16.2657C263.538 11.1594 261.632 7.57433 258.724 5.99206C255.779 4.38994 251.114 4.46727 245.702 8.21748L243.423 4.92958ZM266.665 17.0325C265.482 22.0514 263.382 25.613 260.376 27.5637C257.322 29.5457 253.746 29.6018 250.225 28.479L251.441 24.6681C254.191 25.5453 256.438 25.3514 258.199 24.2084C260.008 23.034 261.716 20.5957 262.772 16.1146L266.665 17.0325ZM249.903 28.3441C241.096 23.7176 241.935 13.5565 248.226 10.7473L249.857 14.3998C247.19 15.5906 245.341 21.4295 251.763 24.803L249.903 28.3441Z"
      fill="black"
    />
    <g class="left-wing">
      <path
        d="M-0.00012207 284.144C-0.00012207 436.542 78.0845 500 188.125 500V150.735C133.911 144.739 116.767 143.24 78.7714 113C30.9043 152.242 -0.00012207 214.301 -0.00012207 284.144Z"
        fill="currentColor"
      />
      <ellipse cx="123.625" cy="426.5" rx="29.5625" ry="31.5" fill="black" />
      <ellipse cx="60.1561" cy="359.5" rx="20.1562" ry="21.5" fill="black" />
      <ellipse cx="138" cy="303" rx="16" ry="17" fill="black" />
      <ellipse cx="106.156" cy="215.5" rx="24.6354" ry="26.5" fill="black" />
      <path
        d="M188.125 150.5C178.271 149.5 178.271 149.5 168.417 148.5C168.417 161.321 176.88 173.045 188.125 175.5V150.5Z"
        fill="black"
      />
    </g>
    <g class="right-wing">
      <path
        d="M387 284.145C387 436.542 308.915 500 198.875 500V150.735C253.088 144.739 270.233 143.24 308.228 113C356.096 152.242 387 214.302 387 284.145Z"
        fill="currentColor"
      />
      <ellipse
        rx="29.5625"
        ry="31.5"
        transform="matrix(-1 0 0 1 263.375 426.5)"
        fill="black"
      />
      <ellipse
        rx="20.1562"
        ry="21.5"
        transform="matrix(-1 0 0 1 325.156 359.5)"
        fill="black"
      />
      <ellipse
        rx="15.5"
        ry="16.5"
        transform="matrix(-1 0 0 1 247.5 302.5)"
        fill="black"
      />
      <ellipse
        rx="24.6354"
        ry="26.5"
        transform="matrix(-1 0 0 1 280.844 215.5)"
        fill="black"
      />
      <path
        d="M198.875 150.5C208.729 149.5 208.729 149.5 218.583 148.5C218.583 161.321 210.12 173.045 198.875 175.5V150.5Z"
        fill="black"
      />
    </g>
  </svg>
  <svg
    v-if="bug.orientation === 'side' && show"
    :width="bug.size * 33.6"
    :height="bug.size * 20"
    class="bug side"
    :class="additionalClasses"
    viewBox="0 0 336 200"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    :style="{
      color: bug.color.color,
      transform: `translate(${bug.translateX || 0},${bug.translateY || 0}) rotate(${
        bug.rotate
      })`,
    }"
    @click="handleClick"
  >
    <path
      :style="{ 'animation-duration': `${Math.random() * 10 + 2}s`, 'animation-name' : beacon ? 'periodicscale' : 'none' }"
      class="stroke"
      d="M190.175 114.938C189.741 114.864 189.297 114.886 188.874 115.002C166.775 121.068 151.824 116.25 137.319 111.554L137.31 111.551C135.729 111.039 134.145 110.526 132.563 110.031C132.382 109.975 132.196 109.936 132.008 109.914C126.637 109.3 120.92 106.561 115.305 102.535C114.276 101.797 112.894 101.785 111.852 102.505C110.509 103.432 109.473 103.516 107.352 103.608L107.332 103.609C105.143 103.704 102.287 103.828 98.4932 105.495C94.7731 107.13 90.3269 110.163 84.5781 115.742C76.4548 123.627 66.5113 124.913 58.1562 123.311C53.9657 122.507 50.2605 120.987 47.514 119.284C44.6105 117.484 43.294 115.81 43.0228 114.971C41.5308 110.36 41.8231 106.836 42.9268 103.733C44.0848 100.478 46.1641 97.5668 48.6306 94.1555L48.749 93.9919C51.6945 89.9189 55.1038 85.2047 56.5833 79.1017C58.3513 71.8086 65.2224 63.5827 72.9089 56.7642C76.6776 53.421 80.5016 50.5396 83.7251 48.4157C87.0786 46.2062 89.4463 45.0428 90.396 44.8053C91.8971 44.4301 92.6965 44.7749 93.154 45.1006C93.7278 45.5091 94.1033 46.1505 94.2515 46.6086C94.6131 47.7262 95.5936 48.5299 96.7603 48.6652C97.9271 48.8005 99.0655 48.2423 99.6732 47.2371C106.468 35.9972 118.696 24.1502 140.753 15.5865C182.624 -0.669144 216.92 1.85929 238.258 8.64865C248.882 12.0289 263.483 19.6096 277.261 29.2481C291.061 38.902 303.689 50.3798 310.63 61.3898C317.606 72.4547 323.016 89.2081 326.431 104.077C328.13 111.471 329.313 118.3 329.947 123.587C330.264 126.235 330.439 128.455 330.478 130.144C330.484 130.396 330.487 130.633 330.486 130.855C327.476 130.774 323.852 130.582 319.908 130.373L319.82 130.368C312.162 129.962 303.38 129.495 296.264 129.75C292.708 129.878 289.394 130.189 286.777 130.841C285.47 131.167 284.196 131.611 283.115 132.252C282.757 132.464 282.397 132.712 282.054 133.002C279.331 132.342 274.642 131.336 268.885 130.145C261.168 128.548 251.313 126.577 241.121 124.576C220.747 120.576 198.965 116.445 190.175 114.938Z"
      stroke="currentColor"
      stroke-width="6"
      stroke-linejoin="round"
    />
    <path
      d="M283.168 136.395C285.668 129.895 319.168 133.895 333.168 133.895C335.168 128.395 327.668 82.7899 313.168 59.7899C298.668 36.7899 261.168 12.7899 239.168 5.78988C217.168 -1.21012 182.168 -3.71011 139.668 12.7899C92.6677 31.0369 88.1677 64.2899 88.1677 77.7899C95.6677 89.3949 114.168 110.895 131.668 112.895C147.668 117.895 164.168 124.895 189.668 117.895C207.168 120.895 276.668 134.395 283.168 136.395Z"
      fill="black"
    />
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M100.168 107.895C101.334 109.395 102.968 112.795 100.168 114.395C97.3676 115.995 93.001 115.062 91.1676 114.395L74.1676 125.395C67.501 130.728 54.0676 142.295 53.6676 145.895C53.5155 147.264 53.0854 149.514 52.603 152.037C51.5003 157.805 50.1242 165.004 51.1676 166.395C51.6268 167.007 51.9054 167.346 52.065 167.512C49.7032 170.221 45.2735 175.607 45.6677 176.395C46.0677 177.195 47.8344 178.062 48.6677 178.395L54.1677 167.895L57.1677 166.395C58.1677 160.062 59.7677 147.095 58.1677 145.895C57.3625 145.291 63.6087 142.174 71.2935 138.34L71.2935 138.34L71.2936 138.34C72.5545 137.711 73.8541 137.063 75.1677 136.403C74.1676 137.895 71.1677 150.895 71.1677 153.395C71.1677 154.457 70.2646 155.881 69.3028 157.397C68.0015 159.449 66.5927 161.67 67.1677 163.395C67.9677 165.795 69.8344 163.728 70.6677 162.395C72.0011 160.062 74.4677 155.095 73.6677 153.895C73.2938 153.334 74.947 150.717 77.0069 147.456C80.4563 141.996 85.046 134.73 83.1677 132.291C90.776 128.248 97.0642 124.378 96.6676 122.395C95.8677 118.395 96.3343 118.395 96.6676 118.895C99.1676 119.109 104.468 118.822 105.668 115.966C106.868 113.109 106.168 108.395 105.668 106.395L100.168 107.895ZM108.668 158.395C108.199 157.926 109.38 149.204 110.87 139.92L110.168 142.395L108.668 146.895C107.668 146.895 105.668 147.195 105.668 148.395C105.668 149.595 101.001 152.895 98.6676 154.395C97.8343 155.728 96.2676 157.595 96.6676 154.395C96.9137 152.426 98.7347 151.547 100.521 150.686C102.363 149.797 104.168 148.926 104.168 146.895C104.168 143.695 106.168 142.562 107.168 142.395C105.968 138.395 109.668 123.109 111.668 115.966V108.395L115.168 106.395L122.168 110.395L117.668 111.395V115.966C120.614 114.714 125.398 113.203 128.168 112.395C132.168 113.228 140.368 115.195 141.168 116.395C141.54 116.953 138.792 117.443 135.274 118.069C129.345 119.125 121.226 120.571 122.168 123.395C123.368 126.995 119.668 149.562 117.668 160.395L114.168 162.395C112.334 169.062 108.368 182.395 107.168 182.395H104.168L92.1677 193.895C91.1677 193.395 89.2677 192.095 89.6677 190.895C90.0677 189.695 98.1677 183.395 102.168 180.395L101.168 178.395C104.168 172.562 110.168 160.795 110.168 160.395C110.168 159.895 109.668 159.395 108.668 158.395L108.668 158.395ZM262.765 145.343C263.971 156.725 264.994 168.793 264.168 169.895C262.968 171.495 275.668 177.895 282.168 180.895V187.395C282.168 187.494 282.538 187.996 283.094 188.751C284.777 191.036 288.168 195.639 288.168 198.395C286.168 199.562 282.168 200.495 282.168 194.895C282.168 190.762 272.755 183.839 265.147 178.245C259.871 174.365 255.463 171.124 255.668 169.895C256.068 167.495 248.834 141.562 245.168 128.895C253.568 128.895 259.334 130.562 261.168 131.395C261.5 134.089 261.891 137.399 262.285 140.937L274.668 145.395C275.834 147.562 278.568 151.995 280.168 152.395C281.768 152.795 279.501 155.562 278.168 156.895L262.765 145.343Z"
      fill="black"
    />
    <path
      d="M89.6684 41.8949C94.4684 40.6949 96.6684 44.0616 97.1684 45.8949C90.5 58 87.1684 78.8949 89.6684 81.3949C91.6684 83.3949 105.168 99.3949 113.668 104.895C107.335 109.395 103.668 101.395 86.6676 117.895C68.6958 135.338 42.602 123.417 40.1684 115.895C34.6685 98.8949 50.1788 92.787 53.6678 78.3949C57.6677 61.8949 83.6684 43.3949 89.6684 41.8949Z"
      fill="#000000"
    />
    <circle class="eye" cx="56" cy="106" r="10" fill="white" />
    <circle cx="52.5" cy="108.5" r="2.5" fill="black" />
    <path
      d="M11.1287 78.3785L11.5299 79.8239L11.5299 79.8239L11.1287 78.3785ZM7.85832 94.1481L7.10152 95.4431L7.14988 95.4714L7.20023 95.496L7.85832 94.1481ZM19.776 91.0745L21.1799 91.6027L21.2273 91.4767L21.2515 91.3443L19.776 91.0745ZM11.8981 82.2811C11.1557 82.6488 10.852 83.5487 11.2197 84.291C11.5874 85.0334 12.4873 85.3371 13.2296 84.9694L11.8981 82.2811ZM51.1482 89.9099C46.4795 87.0499 38.7713 83.1975 31.1152 80.3604C27.2851 78.9412 23.4296 77.7614 19.948 77.0921C16.5082 76.4308 13.2563 76.2311 10.7274 76.9332L11.5299 79.8239C13.3793 79.3104 16.0755 79.4025 19.3816 80.0381C22.6459 80.6657 26.3338 81.788 30.0728 83.1735C37.5546 85.946 45.0861 89.7144 49.581 92.4681L51.1482 89.9099ZM10.7274 76.9332C5.45513 78.3969 2.20597 81.6058 1.5666 85.4197C0.925537 89.2437 3.01451 93.0548 7.10152 95.4431L8.61513 92.853C5.32198 90.9286 4.13949 88.2172 4.52532 85.9157C4.91284 83.6041 6.98892 81.0846 11.5299 79.8239L10.7274 76.9332ZM7.20023 95.496C10.5933 97.1526 13.576 97.6405 16.0559 96.8695C18.5903 96.0815 20.2424 94.0942 21.1799 91.6027L18.3721 90.5462C17.6564 92.4483 16.5675 93.5688 15.1652 94.0048C13.7085 94.4577 11.5591 94.2856 8.51642 92.8001L7.20023 95.496ZM21.2515 91.3443C22.5395 84.3023 16.3526 80.0746 11.8981 82.2811L13.2296 84.9694C15.0607 84.0624 19.2291 85.7269 18.3005 90.8046L21.2515 91.3443Z"
      fill="black"
    />
    <path
      d="M32.1905 71.7955L32.0831 73.2917L32.0831 73.2917L32.1905 71.7955ZM24.7442 84.0229L23.5964 84.9886L23.6325 85.0315L23.6716 85.0715L24.7442 84.0229ZM35.6405 85.0075L36.7854 85.9766L36.8724 85.8739L36.9397 85.7573L35.6405 85.0075ZM31.6501 75.1274C30.8274 75.2244 30.2391 75.97 30.3361 76.7928C30.4331 77.6155 31.1787 78.2038 32.0015 78.1068L31.6501 75.1274ZM62.3857 93.2942C59.3234 89.4968 54.0118 83.9623 48.4405 79.2944C45.6532 76.9591 42.7695 74.8141 40.0436 73.2079C37.3544 71.6234 34.6642 70.4693 32.298 70.2994L32.0831 73.2917C33.7457 73.4111 35.9488 74.2772 38.5207 75.7926C41.0559 77.2864 43.801 79.321 46.5138 81.5939C51.9427 86.1424 57.116 91.5386 60.0504 95.1774L62.3857 93.2942ZM32.298 70.2994C27.4045 69.9479 23.6517 71.6788 21.9366 74.7551C20.2164 77.8404 20.8545 81.7296 23.5964 84.9886L25.892 83.0573C23.7421 80.5018 23.5884 77.953 24.5568 76.216C25.5303 74.4701 27.9466 72.9945 32.0831 73.2917L32.298 70.2994ZM23.6716 85.0715C26.0332 87.4871 28.4227 88.8182 30.7887 88.9155C33.2118 89.0151 35.234 87.8095 36.7854 85.9766L34.4956 84.0384C33.351 85.3906 32.1504 85.9689 30.9119 85.918C29.6164 85.8648 27.9058 85.1111 25.8168 82.9743L23.6716 85.0715ZM36.9397 85.7573C40.1759 80.1494 36.2001 74.5908 31.6501 75.1274L32.0015 78.1068C33.644 77.9131 36.5794 80.3795 34.3413 84.2578L36.9397 85.7573Z"
      fill="black"
    />
    <g class="wing">
      <path
        d="M292.668 114.895C297.868 116.495 322.668 117.395 335.168 114.895C337.168 109.395 328.168 82.3949 313.668 59.3949C299.168 36.3949 261.668 12.3949 239.668 5.39495C217.668 -1.60505 182.668 -4.10504 140.168 12.3949C93.1677 30.642 88.6677 63.895 88.6677 77.395C88.6677 90.895 117.168 99.395 130.168 100.895C143.168 102.395 219.168 104.395 235.668 105.395C252.168 106.395 286.168 112.895 292.668 114.895Z"
        fill="currentColor"
      />
      <path
        d="M103 49.5C102.6 54.3 95.3333 56.8333 92 57.5C90.8 56.7 96.5 46 100.5 40.5C101.333 41.5 103.4 44.7 103 49.5Z"
        fill="black"
      />
      <path
        d="M140 72.2326C140 80.793 133.06 87.7326 124.5 87.7326C119 87.7326 111.5 84.5 111.5 72.2326C111.5 59 118.5 56.7326 124.5 56.7326C133.06 56.7326 140 63.6722 140 72.2326Z"
        fill="#000000"
      />
      <path
        d="M270 56C266.192 48.3331 266.374 37.9183 274.882 33.6925C280.027 32.8118 282 31.5 290.5 39C299 46.5 299.5 54 292 59C280.665 65.017 274.919 62.0137 270 56Z"
        fill="#000000"
      />
      <circle cx="192" cy="38" r="11" fill="#000000" />
      <circle cx="232" cy="84" r="12" fill="#000000" />
    </g>
  </svg>
</template>
<script setup>
const props = defineProps({ slug: String, options: Object, beacon: Boolean });
const emit = defineEmits(["found"]);
const bugTypes = useStateBugTypes();
const show = ref(true);
const bug = reactive({
  ...bugTypes.value.find((i) => (i.gName === props.slug)),
  ...props.options,
});
const additionalClasses = reactive({ escaping: false });
const handleClick = (e) => {
  if (!props.slug) return;
  additionalClasses.escaping = true;
  emit("found");
  setTimeout(() => {
    show.value = false;
    useBugFound(bug);
  }, 1000);
};
</script>
<style lang="postcss">
.bug {
  overflow: visible;
  cursor: pointer;
  transition: all 1s ease-out;
}
.bug .eye {
  transition: fill 50ms;
}
.bug.top .left-wing,
.bug.top .right-wing {
  transform-origin: top center;
}
.bug.top:hover .left-wing,
.bug.top.escaping .left-wing,
.bug.top.angry .left-wing {
  animation: flap-lwing 30ms infinite;
}
.bug.top.escaping {
  transform: translateY(-500px) !important;
  opacity: 0;
}
.bug.side.escaping {
  transform: translateX(-500px);
  opacity: 0;
}
.bug.top:hover .right-wing,
.bug.top.escaping .right-wing,
.bug.top.angry .right-wing {
  animation: flap-rwing 30ms infinite;
}
.bug.side .wing {
  transform-origin: center left;
}
.bug.side:hover .wing,
.bug.side.escaping .wing {
  animation: flap-rwing 30ms infinite;
}
.bug:hover .eye,
.bug.angry .eye {
  fill: #ff0000;
}

.bug .stroke {
  transform-origin: center center;
  animation-timing-function: ease-in;
  animation-duration: 10s;
  animation-iteration-count: infinite;
  stroke-width: 8;
}
.bug.side .stroke {
  transform-origin: center 30%;
}
.bug:hover .stroke {
  animation-duration: 0.5s !important;
  animation-name: periodicscale !important;
}
.bug.escaping .stroke {
  opacity: 0;
}
@keyframes periodicscale {
  0% {
    transform: scale(1);
    opacity: 0;
  }
  50% {
    transform: scale(1);
    opacity: 1;
  }
  100% {
    transform: scale(2);
    opacity: 0;
  }
}
@keyframes flap-lwing {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(5deg);
  }
}
@keyframes flap-rwing {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(-5deg);
  }
}
</style>
