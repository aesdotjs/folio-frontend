<template>
  <transition name="fade">
    <div
      v-if="isLoading"
      class="fixed inset-0 z-50 flex items-center justify-center w-screen h-screen loading"
    >
      <div class="absolute bottom-0 w-full loading-img -z-10">
        <img
          src="~assets/img/loading-img.svg"
          class="object-cover"
          alt="Loading image"
        />
      </div>
      <SakuraGL
        :count="200"
        :size="2.5"
        :depth="80"
        class="absolute inset-0 z-10 w-full h-full"
      ></SakuraGL>
      <svg
        class="logo-loading"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 631.7 733.1"
      >
        <title>logo</title>
        <g id="b4e0f24c-1d10-439e-9479-45537de9dd7a" data-name="Layer 2">
          <g
            id="bcb114ab-fa42-47da-93b7-894e4cf8c902"
            class="icon-svg"
            data-name="Layer 1"
          >
            <path
              d="M395.2,258.6c-71-12.3-153.8-22-241.5-35.5-21.1-3.2-42-6.5-55.3-12.3C26.7,179,92.5,103.3,92.5,103.3c-9,49,20.9,71,61.2,84.1V17.1H359c25.3,0,122,15.8,122,122.8,0,58.9-29.8,85.4-58.7,97.2,28.3,5.6,56.4,11.3,81.9,16.6,51.5-25.3,86.5-68.2,85.1-119.2C589.3,39,484.4,0,395,0H0L39.7,44.4V535.2L0,579.6H422.6S631.7,587,631.7,412.8v-3.1c-.9-43.4-24.7-83.2-61.9-105.6C528,279.1,470.8,271.8,395.2,258.6Zm-9.6,302.5H153.7V244.7l210.1,29.9c41.4,6.3,153.6,15.6,153.6,150.1S385.6,561.1,385.6,561.1Z"
              fill="#fff"
            />
          </g>
          <g class="text-logo">
            <path
              d="M65.2,703.4a16.4,16.4,0,0,1,3.3,10.5c0,5.8-2.2,10.3-6.7,13.5s-11,4.7-19.5,4.7H9v-67H40.4c7.9,0,14,1.6,18.3,4.7a15.1,15.1,0,0,1,6.4,12.7,18.1,18.1,0,0,1-2.3,8.8,15.6,15.6,0,0,1-6.3,5.9A17.6,17.6,0,0,1,65.2,703.4ZM21.4,674.9v18.5H39.1c4.3,0,7.6-.8,10-2.4a7.7,7.7,0,0,0,3.4-6.8,7.5,7.5,0,0,0-3.4-6.9c-2.4-1.6-5.7-2.4-10-2.4ZM56,712.7c0-6.4-4.8-9.7-14.5-9.7H21.4v19.4H41.5C51.2,722.4,56,719.1,56,712.7Z"
              fill="#fff"
            />
            <path d="M93.3,665.2h12.4v56.4h35v10.5H93.3Z" fill="#fff" />
            <path
              d="M168.3,725.3c-5.2-5.2-7.8-12.7-7.8-22.3V665.2h12.4v37.3c0,13.1,5.7,19.7,17,19.7s17-6.6,17-19.7V665.2h12.2v37.7c0,9.7-2.6,17.2-7.7,22.4s-12.3,7.8-21.6,7.8S173.4,730.5,168.3,725.3Z"
              fill="#fff"
            />
            <path
              d="M291.8,732.1l-13.7-19.6H260.4v19.5H248v-67h27.6a37.3,37.3,0,0,1,15.1,2.9,21.9,21.9,0,0,1,10,8.3,23.5,23.5,0,0,1,3.4,12.7,22.9,22.9,0,0,1-3.7,13,22.1,22.1,0,0,1-10.5,8.1l15.4,22Zm-4.5-53c-2.8-2.3-6.9-3.4-12.3-3.4H260.4v26.6H275c5.4,0,9.5-1.1,12.3-3.4a12.3,12.3,0,0,0,4.2-9.9q0-6.4-4.2-9.9Z"
              fill="#fff"
            />
            <path
              d="M379.6,721.7v10.4H329.4v-67h48.9v10.4H341.8V693h32.4v10.2H341.8v18.5Z"
              fill="#fff"
            />
            <path
              d="M410.7,730.9a33.5,33.5,0,0,1-11.4-5.9l4.3-9.6a33.6,33.6,0,0,0,10.1,5.3,37.3,37.3,0,0,0,12,2c4.9,0,8.7-.8,11.1-2.4a7.1,7.1,0,0,0,3.7-6.3,6.1,6.1,0,0,0-2.1-4.7,14.8,14.8,0,0,0-5.2-2.9c-2.1-.7-4.9-1.5-8.6-2.4a110,110,0,0,1-12.4-3.7,20.7,20.7,0,0,1-8.1-5.6c-2.3-2.6-3.4-6.1-3.4-10.5a18.1,18.1,0,0,1,3-10.1,20.8,20.8,0,0,1,9.1-7.2,37.9,37.9,0,0,1,14.9-2.7,48.7,48.7,0,0,1,12,1.5,34.8,34.8,0,0,1,10.3,4.4l-4,9.7a36.8,36.8,0,0,0-9.1-3.9,37.4,37.4,0,0,0-9.3-1.4c-4.9,0-8.6.9-11,2.5a7.6,7.6,0,0,0-3.6,6.6,6,6,0,0,0,2,4.7,15.2,15.2,0,0,0,5.3,2.9c2.1.7,4.9,1.5,8.6,2.4a89.4,89.4,0,0,1,12.2,3.6,21.1,21.1,0,0,1,8.2,5.6c2.2,2.6,3.4,6,3.4,10.4a18,18,0,0,1-3,10,20.2,20.2,0,0,1-9.2,7.1,35.8,35.8,0,0,1-14.8,2.8A54.4,54.4,0,0,1,410.7,730.9Z"
              fill="#fff"
            />
            <path
              d="M489.3,728.6a31.6,31.6,0,0,1-12.8-12.3,35.5,35.5,0,0,1,0-35.4,32.9,32.9,0,0,1,12.8-12.3,38.1,38.1,0,0,1,18.4-4.4,37.1,37.1,0,0,1,15,2.9,30.3,30.3,0,0,1,11.4,8.3l-8,7.5a23.6,23.6,0,0,0-17.8-7.8,25.5,25.5,0,0,0-12.4,3,21.5,21.5,0,0,0-8.5,8.4,25.5,25.5,0,0,0,0,24.3,21.9,21.9,0,0,0,8.5,8.3,24.5,24.5,0,0,0,12.4,3,23.3,23.3,0,0,0,17.8-7.9l8,7.6a29.5,29.5,0,0,1-11.4,8.4,41,41,0,0,1-15.1,2.9A37.6,37.6,0,0,1,489.3,728.6Z"
              fill="#fff"
            />
            <path
              d="M599.6,716.6H566.1l-6.6,15.5H546.7l30.1-67H589l30.3,67h-13Zm-4.1-9.7-12.7-29.3-12.5,29.3Z"
              fill="#fff"
            />
          </g>
        </g>
        <!-- Code injected by live-server -->
      </svg>
    </div>
  </transition>
</template>
<style lang="postcss">
body.is-loading {
  overflow: hidden;
}
.loading {
  background: linear-gradient(
    to top,
    #ffba96 9%,
    #f4ab94 31%,
    #d7848f 74%,
    #c3698c 100%
  );
}
.logo-loading {
  max-width: 17.5rem;
  width: 100%;
  padding: 30px;
  opacity: 0;
}
.loading .logo-loading .text-logo path {
  opacity: 0;
}

.loading .logo-loading .icon-svg path {
  stroke: transparent;
  stroke-width: 2px;
}
.fade-enter-active,
.fade-leave-active {
  transition: opacity 1s;
}
.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {
  opacity: 0;
}
</style>

<script>
export default {
  data() {
    return {
      isLoading: false,
    };
  },
  mounted() {
    this.$nextTick(() => {
      this.drawLogo();
    });
  },
  methods: {
    start() {
      this.isLoading = true;
      this.$nextTick(() => {
        this.drawLogo();
      });
    },
    finish() {
      this.isLoading = false;
    },
    drawLogo() {
      let draw = this.$anime.timeline({
        easing: "easeOutExpo",
        duration: 2500,
        endDelay: 500,
      });

      draw
        .add({
          targets: ".loading .logo-loading",
          opacity: [0, 1],
          easing: "easeInOutSine",
          duration: 500,
        })
        .add({
          targets: ".loading .icon-svg path",
          strokeDashoffset: [this.$anime.setDashoffset, 0],
          stroke: { value: "#fff" },
          easing: "easeInOutSine",
          duration: 1800,
        })
        .add(
          {
            targets: ".loading .icon-svg path",
            fillOpacity: [0, 1],
            easing: "easeInOutCubic",
            duration: 800,
          },
          "-=1000"
        )
        .add(
          {
            targets: ".loading .text-logo path",
            opacity: [0, 1],
            translateX: [-25, 0],
            // rotateY: ['-18deg', 0],
            delay: this.$anime.stagger(100),
          },
          "-=900"
        )
        .add(
          {
            targets: ".loading .icon-svg path",
            // loop: true,
            // direction: 'alternate',
            strokeOpacity: [1, 0],
            easing: "easeInOutSine",
            duration: 800,
          },
          "-=1100"
        );
    },
  },
  head() {
    return {
      bodyAttrs: {
        class: this.isLoading ? "is-loading" : "",
      },
    };
  },
};
</script>
