<template>
  <Transition name="toast">
    <div
      class="toast fixed top-0 z-40 w-full pointer-events-none transition-all"
      v-if="isToastVisible"
    >
      <div class="w-full flex justify-center mt-12">
        <svg
          :width="38.7 * 2"
          :height="50 * 2"
          :style="{ color : bug.color }"
          class="bug top angry"
          viewBox="0 0 387 500"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M386.104 285.242C386.104 440.067 299.872 500 193.5 500C87.1276 500 0.895752 437.57 0.895752 285.242C0.895752 215.43 30.77 153.399 77.0416 114.174C118.698 89.9617 129.448 54.4999 193.5 54.4999C257.552 54.5 269.646 89.9617 309.958 114.174C356.23 153.399 386.104 215.43 386.104 285.242Z"
            fill="#000000"
          />
          <ellipse class="eye" cx="163.489" cy="86.5" rx="12.9896" ry="14.5" fill="white" />
          <ellipse class="eye" cx="223.51" cy="86.5" rx="12.9896" ry="14.5" fill="white" />
          <ellipse cx="166.625" cy="79" rx="3.58333" ry="4" fill="#000000" />
          <ellipse cx="220.375" cy="81" rx="3.58333" ry="4" fill="#000000" />
          <path
            d="M142.193 6.57353L141.054 8.21748L141.054 8.21749L142.193 6.57353ZM122.037 16.5735L120.061 16.8814L120.073 16.9575L120.09 17.0325L122.037 16.5735ZM135.923 26.5735L136.53 28.479L136.697 28.4257L136.853 28.3441L135.923 26.5735ZM138.53 10.7473C137.521 10.297 136.338 10.7495 135.888 11.7581C135.438 12.7667 135.89 13.9494 136.899 14.3998L138.53 10.7473ZM164.78 58.8082C163.791 51.4191 161.205 39.9637 157.554 29.431C155.727 24.1616 153.616 19.0706 151.276 14.8121C148.963 10.6008 146.316 6.99668 143.332 4.92957L141.054 8.21749C143.267 9.75039 145.55 12.6962 147.771 16.7381C149.965 20.7328 151.992 25.5979 153.775 30.7411C157.342 41.0334 159.863 52.228 160.815 59.3389L164.78 58.8082ZM143.332 4.92958C137.099 0.610866 130.79 -0.0618017 126.12 2.47832C121.414 5.03829 119.065 10.4877 120.061 16.8814L124.013 16.2657C123.218 11.1594 125.123 7.57433 128.032 5.99206C130.977 4.38994 135.641 4.46727 141.054 8.21748L143.332 4.92958ZM120.09 17.0325C121.274 22.0514 123.374 25.613 126.379 27.5637C129.433 29.5457 133.01 29.6018 136.53 28.479L135.315 24.6681C132.565 25.5453 130.318 25.3514 128.557 24.2084C126.747 23.034 125.04 20.5957 123.984 16.1146L120.09 17.0325ZM136.853 28.3441C145.66 23.7176 144.821 13.5565 138.53 10.7473L136.899 14.3998C139.565 15.5906 141.414 21.4295 134.992 24.803L136.853 28.3441Z"
            fill="black"
          />
          <path
            d="M244.562 6.57353L245.702 8.21748L245.702 8.21749L244.562 6.57353ZM264.719 16.5735L266.695 16.8814L266.683 16.9575L266.665 17.0325L264.719 16.5735ZM250.833 26.5735L250.225 28.479L250.058 28.4257L249.903 28.3441L250.833 26.5735ZM248.226 10.7473C249.235 10.297 250.417 10.7495 250.868 11.7581C251.318 12.7667 250.865 13.9494 249.857 14.3998L248.226 10.7473ZM221.976 58.8082C222.965 51.4191 225.55 39.9637 229.202 29.431C231.028 24.1616 233.14 19.0706 235.479 14.8121C237.793 10.6008 240.44 6.99668 243.423 4.92957L245.702 8.21749C243.489 9.75039 241.206 12.6962 238.985 16.7381C236.79 20.7328 234.764 25.5979 232.981 30.7411C229.413 41.0334 226.892 52.228 225.94 59.3389L221.976 58.8082ZM243.423 4.92958C249.657 0.610866 255.966 -0.0618017 260.635 2.47832C265.341 5.03829 267.691 10.4877 266.695 16.8814L262.743 16.2657C263.538 11.1594 261.632 7.57433 258.724 5.99206C255.779 4.38994 251.114 4.46727 245.702 8.21748L243.423 4.92958ZM266.665 17.0325C265.482 22.0514 263.382 25.613 260.376 27.5637C257.322 29.5457 253.746 29.6018 250.225 28.479L251.441 24.6681C254.191 25.5453 256.438 25.3514 258.199 24.2084C260.008 23.034 261.716 20.5957 262.772 16.1146L266.665 17.0325ZM249.903 28.3441C241.096 23.7176 241.935 13.5565 248.226 10.7473L249.857 14.3998C247.19 15.5906 245.341 21.4295 251.763 24.803L249.903 28.3441Z"
            fill="black"
          />
          <g class="left-wing">
            <path
              d="M-0.00012207 284.144C-0.00012207 436.542 78.0845 500 188.125 500V150.735C133.911 144.739 116.767 143.24 78.7714 113C30.9043 152.242 -0.00012207 214.301 -0.00012207 284.144Z"
              fill="currentColor"
            />
            <ellipse cx="123.625" cy="426.5" rx="29.5625" ry="31.5" fill="black" />
            <ellipse cx="60.1561" cy="359.5" rx="20.1562" ry="21.5" fill="black" />
            <ellipse cx="138" cy="303" rx="16" ry="17" fill="black" />
            <ellipse cx="106.156" cy="215.5" rx="24.6354" ry="26.5" fill="black" />
            <path
              d="M188.125 150.5C178.271 149.5 178.271 149.5 168.417 148.5C168.417 161.321 176.88 173.045 188.125 175.5V150.5Z"
              fill="black"
            />
          </g>
          <g class="right-wing">
            <path
              d="M387 284.145C387 436.542 308.915 500 198.875 500V150.735C253.088 144.739 270.233 143.24 308.228 113C356.096 152.242 387 214.302 387 284.145Z"
              fill="currentColor"
            />
            <ellipse
              rx="29.5625"
              ry="31.5"
              transform="matrix(-1 0 0 1 263.375 426.5)"
              fill="black"
            />
            <ellipse
              rx="20.1562"
              ry="21.5"
              transform="matrix(-1 0 0 1 325.156 359.5)"
              fill="black"
            />
            <ellipse
              rx="15.5"
              ry="16.5"
              transform="matrix(-1 0 0 1 247.5 302.5)"
              fill="black"
            />
            <ellipse
              rx="24.6354"
              ry="26.5"
              transform="matrix(-1 0 0 1 280.844 215.5)"
              fill="black"
            />
            <path
              d="M198.875 150.5C208.729 149.5 208.729 149.5 218.583 148.5C218.583 161.321 210.12 173.045 198.875 175.5V150.5Z"
              fill="black"
            />
          </g>
        </svg>
      </div>
      <div class="toast-text mt-4 px-6 text-center text-2xl lg:text-3xl font-retro text-white">
        You have found the
        <div
          class="hero glitch layers"
          :data-text="`${bug.type} bug`"
          :style="{
            color: shadedColor,
            'text-shadow': `0 0 10px ${bug.color}`,
          }">
          <span>{{ bug.type }} bug </span>
        </div>
        !
      </div>
    </div>
  </Transition>
</template>
<style scoped>
.toast-enter-active, .toast-leave-active {
  transition: all 1s cubic-bezier(0.2, 0.5, 0.1, 1);
}
.toast-leave-to,
.toast-enter-from {
  opacity:0;
}
.toast {
  filter: drop-shadow(0 0 0.2em black);
}
.bug {
  transform: rotate(45deg);
}
.hero {
  display: inline-block;
}
.layers {
  position: relative;
}

.layers::before,
.layers::after {
  content: attr(data-text);
  position: absolute;
  width: 110%;
  z-index: -1;
}

.layers::before {
  top: 10px;
  left: 15px;
  color: var(--color-aesblue);
}

.layers::after {
  top: 5px;
  left: -10px;
  color: var(--color-aespurple2);
}
.glitch span {
  animation: paths 5s step-end infinite;
}

.glitch::before {
  animation: paths 5s step-end infinite, opacity 5s step-end infinite,
    font 8s step-end infinite, movement 10s step-end infinite;
}

.glitch::after {
  animation: paths 5s step-end infinite, opacity 5s step-end infinite,
    font 7s step-end infinite, movement 8s step-end infinite;
}
@keyframes paths {
  0% {
    clip-path: polygon(
      0% 43%,
      83% 43%,
      83% 22%,
      23% 22%,
      23% 24%,
      91% 24%,
      91% 26%,
      18% 26%,
      18% 83%,
      29% 83%,
      29% 17%,
      41% 17%,
      41% 39%,
      18% 39%,
      18% 82%,
      54% 82%,
      54% 88%,
      19% 88%,
      19% 4%,
      39% 4%,
      39% 14%,
      76% 14%,
      76% 52%,
      23% 52%,
      23% 35%,
      19% 35%,
      19% 8%,
      36% 8%,
      36% 31%,
      73% 31%,
      73% 16%,
      1% 16%,
      1% 56%,
      50% 56%,
      50% 8%
    );
  }

  5% {
    clip-path: polygon(
      0% 29%,
      44% 29%,
      44% 83%,
      94% 83%,
      94% 56%,
      11% 56%,
      11% 64%,
      94% 64%,
      94% 70%,
      88% 70%,
      88% 32%,
      18% 32%,
      18% 96%,
      10% 96%,
      10% 62%,
      9% 62%,
      9% 84%,
      68% 84%,
      68% 50%,
      52% 50%,
      52% 55%,
      35% 55%,
      35% 87%,
      25% 87%,
      25% 39%,
      15% 39%,
      15% 88%,
      52% 88%
    );
  }

  30% {
    clip-path: polygon(
      0% 53%,
      93% 53%,
      93% 62%,
      68% 62%,
      68% 37%,
      97% 37%,
      97% 89%,
      13% 89%,
      13% 45%,
      51% 45%,
      51% 88%,
      17% 88%,
      17% 54%,
      81% 54%,
      81% 75%,
      79% 75%,
      79% 76%,
      38% 76%,
      38% 28%,
      61% 28%,
      61% 12%,
      55% 12%,
      55% 62%,
      68% 62%,
      68% 51%,
      0% 51%,
      0% 92%,
      63% 92%,
      63% 4%,
      65% 4%
    );
  }

  45% {
    clip-path: polygon(
      0% 33%,
      2% 33%,
      2% 69%,
      58% 69%,
      58% 94%,
      55% 94%,
      55% 25%,
      33% 25%,
      33% 85%,
      16% 85%,
      16% 19%,
      5% 19%,
      5% 20%,
      79% 20%,
      79% 96%,
      93% 96%,
      93% 50%,
      5% 50%,
      5% 74%,
      55% 74%,
      55% 57%,
      96% 57%,
      96% 59%,
      87% 59%,
      87% 65%,
      82% 65%,
      82% 39%,
      63% 39%,
      63% 92%,
      4% 92%,
      4% 36%,
      24% 36%,
      24% 70%,
      1% 70%,
      1% 43%,
      15% 43%,
      15% 28%,
      23% 28%,
      23% 71%,
      90% 71%,
      90% 86%,
      97% 86%,
      97% 1%,
      60% 1%,
      60% 67%,
      71% 67%,
      71% 91%,
      17% 91%,
      17% 14%,
      39% 14%,
      39% 30%,
      58% 30%,
      58% 11%,
      52% 11%,
      52% 83%,
      68% 83%
    );
  }

  76% {
    clip-path: polygon(
      0% 26%,
      15% 26%,
      15% 73%,
      72% 73%,
      72% 70%,
      77% 70%,
      77% 75%,
      8% 75%,
      8% 42%,
      4% 42%,
      4% 61%,
      17% 61%,
      17% 12%,
      26% 12%,
      26% 63%,
      73% 63%,
      73% 43%,
      90% 43%,
      90% 67%,
      50% 67%,
      50% 41%,
      42% 41%,
      42% 46%,
      50% 46%,
      50% 84%,
      96% 84%,
      96% 78%,
      49% 78%,
      49% 25%,
      63% 25%,
      63% 14%
    );
  }

  90% {
    clip-path: polygon(
      0% 41%,
      13% 41%,
      13% 6%,
      87% 6%,
      87% 93%,
      10% 93%,
      10% 13%,
      89% 13%,
      89% 6%,
      3% 6%,
      3% 8%,
      16% 8%,
      16% 79%,
      0% 79%,
      0% 99%,
      92% 99%,
      92% 90%,
      5% 90%,
      5% 60%,
      0% 60%,
      0% 48%,
      89% 48%,
      89% 13%,
      80% 13%,
      80% 43%,
      95% 43%,
      95% 19%,
      80% 19%,
      80% 85%,
      38% 85%,
      38% 62%
    );
  }

  1%,
  7%,
  33%,
  47%,
  78%,
  93% {
    clip-path: none;
  }
}

@keyframes movement {
  0% {
    top: 0px;
    left: -20px;
  }

  15% {
    top: 10px;
    left: 10px;
  }

  60% {
    top: 5px;
    left: -10px;
  }

  75% {
    top: -5px;
    left: 20px;
  }

  100% {
    top: 10px;
    left: 5px;
  }
}


@keyframes opacity {
  0% {
    opacity: 0.1;
  }

  5% {
    opacity: 0.7;
  }

  30% {
    opacity: 0.4;
  }

  45% {
    opacity: 0.6;
  }

  76% {
    opacity: 0.4;
  }

  90% {
    opacity: 0.8;
  }

  1%,
  7%,
  33%,
  47%,
  78%,
  93% {
    opacity: 0;
  }
}


@keyframes font {
  0% {
    font-weight: 100;
    color: var(--color-aespurple1)!important;
    filter: blur(3px);
  }

  20% {
    font-weight: 500;
    color: #fff!important;
    filter: blur(0);
  }

  50% {
    font-weight: 300;
    color: var(--color-aesblue)!important;
    filter: blur(2px);
  }

  60% {
    font-weight: 700;
    color: #fff!important;
    filter: blur(0);
  }

  90% {
    font-weight: 500;
    color: var(--color-aespurple1)!important;
    filter: blur(6px);
  }
}
</style>
<script setup>
const { isToastVisible, bug } = useBugToast();
const shadedColor = computed(() => shadeColor(bug.value.color, 240));
const shadeColor = function (colorCode, amount) {
  var usePound = false;

  if (colorCode[0] == "#") {
    colorCode = colorCode.slice(1);
    usePound = true;
  }

  var num = parseInt(colorCode, 16);

  var r = (num >> 16) + amount;

  if (r > 255) {
    r = 255;
  } else if (r < 0) {
    r = 0;
  }

  var b = ((num >> 8) & 0x00ff) + amount;
  if (b > 255) {
    b = 255;
  } else if (b < 0) {
    b = 0;
  }

  var g = (num & 0x0000ff) + amount;

  if (g > 255) {
    g = 255;
  } else if (g < 0) {
    g = 0;
  }

  return (usePound ? "#" : "") + (g | (b << 8) | (r << 16)).toString(16);
};
</script>
